<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <title>Simple Map</title>

        <!-- Include Leaflet CSS and JavaScript -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
    <!-- Define the map's CSS styles -->
        <style>
            /* Set the body and HTML to full height */
            body, html {
                height: 100%;
                margin: 0;
            }
            
            /* Make the map container full height */
            #map {
                height: 90vh; /* 100% of the viewport height */
                width: 100%;    /* 100% of the viewport width */
            }
        
            /* Center the button */
            #button-container {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 15vh; /* 15% of the viewport height */
            }
        </style>
    </head>
    <body>

    <!-- Create a Bootstrap row to hold the map -->
    <div class="row">
        <!-- Map column (takes up 9 out of 12 columns) -->
        <div class="col-md-9">
            <div id="map"></div>
        </div>
        <!-- Button column (takes up 3 out of 12 columns) -->
        <div class="col-md-3">
            <div class="text-center mt-4">
                <a href="/formb" class="btn btn-primary">Review Form</a>
            </div>
        </div>
    </div>
    <!-- Create a separate row for the button beneath the map -->
    <div class="row">
        <div id="button-container">
            <a href="/forma" class="btn btn-primary">Submit location info</a>
        </div>
    </div>

    <script>
    var map = L.map('map');

    // Function to initialize the map with user location or default coordinates
    function initializeMapWithUserLocation() {
        if ("geolocation" in navigator) {
            // Request user's location
            navigator.geolocation.getCurrentPosition(function (position) {
            // User's location is available
            var userLatitude = position.coords.latitude;
            var userLongitude = position.coords.longitude;

            // Set the map view to the user's coordinates
            map.setView([userLatitude, userLongitude], 15);

            // Add OpenStreetMap tiles as a basemap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            }, function (error) {
                // User denied or failed to provide location; display an atoll island
                setDefaultMap();
            });
        } else {
    // Geolocation not supported; display an atoll island
    setDefaultMap();
  }
}

            // Function to set the map to default coordinates (Atoll Island)
    function setDefaultMap() {
        map.setView([0, 0], 2); // Set to Atoll Island or any other default location
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
    }

    // Call the function to initialize the map based on user location or default
    initializeMapWithUserLocation();
    </script>
    </body>
</html>
